<!DOCTYPE html>
<html lang="lt">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Traumos forma – Desktop v9 (SVG kūno žemėlapis)</title>
<link rel="stylesheet" href="css/main.css">
</head>
<body>
<header>
  <div class="wrap">
    <h1>Traumos forma – Desktop v9</h1>
    <div class="sub">Aktyvacija (EMS) · ABCDE · LT · SVG kūno žemėlapis</div>
    <div class="toolbar">
      <button class="btn primary" id="btnGen">Sugeneruoti ataskaitą</button>
      <button class="btn" id="btnCopy">Kopijuoti</button>
      <button class="btn" id="btnSave">Išsaugoti</button>
      <button class="btn ghost" id="btnClear">Išvalyti</button>
      <button class="btn warn" onclick="window.print()">🖨 Spausdinti</button>
    </div>
  </div>
</header>

<main>
  <nav id="tabs"></nav>

  <div id="views">
    <!-- Aktyvacija (EMS) -->
    <section class="card view" data-tab="Aktyvacija (EMS)">
      <h2>Traumos komandos aktyvacija <span class="badge">EMS rodikliai → auto</span></h2>
      <div class="grid cols-3">
        <div><label>EMS ŠSD (k./min)</label><input id="ems_hr" type="number" min="0" max="250"></div>
        <div><label>EMS KD (k./min)</label><input id="ems_rr" type="number" min="0" max="80"></div>
        <div><label>EMS SpO₂ (%)</label><input id="ems_spo2" type="number" min="0" max="100"></div>
      </div>
      <div class="grid cols-3" style="margin-top:8px">
        <div class="row"><div style="flex:1"><label>EMS AKS s</label><input id="ems_sbp" type="number" min="0" max="300"></div><div style="flex:1"><label>EMS AKS d</label><input id="ems_dbp" type="number" min="0" max="200"></div></div>
        <div><label>EMS GKS (A-K-M)</label><div class="row"><input id="ems_gksa" type="number" min="1" max="4" placeholder="A"><input id="ems_gksk" type="number" min="1" max="5" placeholder="K"><input id="ems_gksm" type="number" min="1" max="6" placeholder="M"></div></div>
        <div><label>EMS Temperatūra (nebūtina)</label><input id="ems_temp" type="number" step="0.1"></div>
      </div>
      <div class="split" style="margin-top:12px">
        <div>
          <label><strong>RAUDONA</strong></label>
          <div class="chip-group" id="chips_red">
            <button type="button" class="chip red" data-value="GKS &lt; 9" aria-pressed="false">GKS &lt; 9</button>
            <button type="button" class="chip red" data-value="KD &lt; 8 ar &gt; 30/min" aria-pressed="false">KD &lt; 8 ar &gt; 30/min</button>
            <button type="button" class="chip red" data-value="AKS &lt; 90 mmHg" aria-pressed="false">AKS &lt; 90 mmHg</button>
            <button type="button" class="chip red" data-value="SpO₂ &lt; 90%" aria-pressed="false">SpO₂ &lt; 90%</button>
            <button type="button" class="chip red" data-value="ŠSD &gt; 120/min" aria-pressed="false">ŠSD &gt; 120/min</button>
            <button type="button" class="chip red" data-value="Stridoras" aria-pressed="false">Stridoras</button>
            <button type="button" class="chip red" data-value="Lūžę 2 ilgieji kaulai/dubuo" aria-pressed="false">Lūžę 2 ilgieji kaulai/dubuo</button>
            <button type="button" class="chip red" data-value="Kiauriniai suž. kakle/krūtinėje/juosmenyje" aria-pressed="false">Kiauriniai suž. kakle/krūtinėje/juosmenyje</button>
            <button type="button" class="chip red" data-value="Įtariamas vidinis kraujavimas" aria-pressed="false">Įtariamas vidinis kraujavimas</button>
            <button type="button" class="chip red" data-value="Nestabili krūtinės ląsta" aria-pressed="false">Nestabili krūtinės ląsta</button>
            <button type="button" class="chip red" data-value="Nudegimas &gt;18% ar KT nudegimas" aria-pressed="false">Nudegimas &gt;18% ar KT nudegimas</button>
            <button type="button" class="chip red" data-value="Amputacijos aukščiau plašt./pėdų" aria-pressed="false">Amputacijos aukščiau plašt./pėdų</button>
          </div>
        </div>
        <div>
          <label><strong>GELTONA</strong></label>
          <div class="chip-group" id="chips_yellow">
            <button type="button" class="chip yellow" data-value="Pėst./dvir./motociklo trauma" aria-pressed="false">Pėst./dvir./motociklo trauma</button>
            <button type="button" class="chip yellow" data-value="Sprogimas/susišaudymas" aria-pressed="false">Sprogimas/susišaudymas</button>
            <button type="button" class="chip yellow" data-value="Kritimas &gt;3 m ar nardymas" aria-pressed="false">Kritimas &gt;3 m ar nardymas</button>
            <button type="button" class="chip yellow" data-value="Reikėjo gelbėtojų pagalbos" aria-pressed="false">Reikėjo gelbėtojų pagalbos</button>
          </div>
        </div>
      </div>
      <div class="hint" style="margin-top:6px">Auto-aktyvacija – tik iš EMS rodiklių; rankiniai pakeitimai išlieka.</div>
    </section>

    <!-- A -->
    <section class="card view" data-tab="A – Kvėpavimo takai">
      <h2>A – Kvėpavimo takai</h2>
      <label>Takai</label>
      <div class="chip-group" id="a_airway_group" data-single="true">
        <button type="button" class="chip" data-value="Atviri" aria-pressed="false">Atviri</button>
        <button type="button" class="chip" data-value="Užtikrinti (intub./GMP)" aria-pressed="false">Užtikrinti (intub./GMP)</button>
        <button type="button" class="chip" data-value="Kita" aria-pressed="false">Kita</button>
      </div>
      <div class="row" style="margin-top:8px"><label style="margin:0">Pastabos</label><input id="a_notes" type="text" placeholder="Trumpai..."></div>
    </section>

    <!-- B -->
    <section class="card view" data-tab="B – Kvėpavimas">
      <h2>B – Kvėpavimas</h2>
      <div class="grid cols-3">
        <div><label>KD (k./min)</label><input id="b_rr" type="number" min="0" max="80"></div>
        <div><label>SpO₂ (%)</label><input id="b_spo2" type="number" min="0" max="100"></div>
        <div>
          <label>Alsavimas</label>
          <div class="row">
            <div><div class="subtle">Kairė</div><div class="chip-group" id="b_breath_left_group" data-single="true"><button type="button" class="chip" data-value="+" aria-pressed="false">+</button><button type="button" class="chip" data-value="-" aria-pressed="false">-</button></div></div>
            <div><div class="subtle">Dešinė</div><div class="chip-group" id="b_breath_right_group" data-single="true"><button type="button" class="chip" data-value="+" aria-pressed="false">+</button><button type="button" class="chip" data-value="-" aria-pressed="false">-</button></div></div>
          </div>
        </div>
      </div>
    </section>

    <!-- C -->
    <section class="card view" data-tab="C – Kraujotaka">
      <h2>C – Kraujotaka</h2>
      <div class="grid cols-3">
        <div><label>ŠSD (k./min)</label><input id="c_hr" type="number" min="0" max="250"></div>
        <div class="row"><div style="flex:1"><label>AKS s</label><input id="c_sbp" type="number" min="0" max="300"></div><div style="flex:1"><label>AKS d</label><input id="c_dbp" type="number" min="0" max="200"></div></div>
        <div><label>KPL (sek.)</label><input id="c_caprefill" type="number" step="0.1" min="0" max="20"></div>
      </div>
    </section>

    <!-- D -->
    <section class="card view" data-tab="D – Sąmonė">
      <h2>D – Sąmonė</h2>
      <div class="grid cols-3">
        <div>
          <label>GKS (A-K-M) <span class="subtle">(15b. mygtukas užpildo 4/5/6)</span></label>
          <div class="row">
            <input id="d_gksa" type="number" min="1" max="4" placeholder="A">
            <input id="d_gksk" type="number" min="1" max="5" placeholder="K">
            <input id="d_gksm" type="number" min="1" max="6" placeholder="M">
            <button class="btn" id="btnGCS15">15b.</button>
          </div>
        </div>
        <div>
          <label>Vyzdžiai – Kairė</label>
          <div class="chip-group" id="d_pupil_left_group" data-single="true"><button type="button" class="chip" data-value="n.y." aria-pressed="false">n.y.</button><button type="button" class="chip" data-value="kita" aria-pressed="false">kita</button></div>
          <input id="d_pupil_left_note" type="text" placeholder="Pastabos..." style="margin-top:6px;display:none">
        </div>
        <div>
          <label>Vyzdžiai – Dešinė</label>
          <div class="chip-group" id="d_pupil_right_group" data-single="true"><button type="button" class="chip" data-value="n.y." aria-pressed="false">n.y.</button><button type="button" class="chip" data-value="kita" aria-pressed="false">kita</button></div>
          <input id="d_pupil_right_note" type="text" placeholder="Pastabos..." style="margin-top:6px;display:none">
        </div>
      </div>
      <div class="row" style="margin-top:8px"><label style="margin:0">Pastabos</label><input id="d_notes" type="text" placeholder="Trumpai..."></div>
    </section>

    <!-- E -->
    <section class="card view" data-tab="E – Kita">
      <h2>E – Kita</h2>
      <div class="grid cols-3">
        <div><label>Temperatūra (°C)</label><input id="e_temp" type="number" step="0.1" min="30" max="43"></div>
        <div><label>Nugaros apžiūra</label><div class="row"><label class="pill"><input id="e_back_ny" type="checkbox"> n.y.</label><input id="e_back_notes" type="text" placeholder="Pastabos..."></div></div>
        <div><label>Kitos pastabos</label><input id="e_other" type="text" placeholder="..."></div>
      </div>

      <div class="divider"></div>
      <h3 style="font-size:14px;margin:0 0 6px;color:var(--muted)">Kūno žemėlapis (SVG) – Žaizda (Ž), Sumušimas (S), Nudegimas (N)</h3>
      <div class="map-toolbar">
        <button class="tool" data-tool="Ž">Žaizda</button>
        <button class="tool" data-tool="S">Sumušimas</button>
        <button class="tool" data-tool="N">Nudegimas</button>
        <span style="flex:1"></span>
        <button class="tool" id="btnSide">↺ Rodyti: Priekis</button>
        <button class="tool" id="btnUndo">↩ Anuliuoti</button>
        <button class="tool" id="btnClearMap">🧹 Išvalyti</button>
        <button class="tool" id="btnExportSvg">⬇ Eksportuoti SVG</button>
      </div>

      <!-- SVG BODY MAP -->
      <svg id="bodySvg" viewBox="0 0 400 900" xmlns="http://www.w3.org/2000/svg">
        <!-- Marker symbols -->
        <defs>
          <g id="sym-wound">
            <circle r="14" class="mark-w"/>
            <path d="M-10 0 L10 0 M0 -10 L0 10" class="mark-w"/>
          </g>
          <g id="sym-bruise">
            <circle r="10" class="mark-b"/>
          </g>
          <g id="sym-burn">
            <polygon points="0,-12 12,0 0,12 -12,0" class="mark-n"/>
          </g>
        </defs>

        <!-- FRONT silhouette -->
        <g id="layer-front">
          <text x="16" y="28" class="label">PRIEKIS</text>
          <g class="silhouette" id="front-shape">
            <!-- galva -->
            <circle cx="200" cy="90" r="52"/>
            <!-- kaklas -->
            <path d="M180,142 L220,142 L228,160 L172,160 Z"/>
            <!-- liemuo -->
            <path d="M110,160 C70,210 80,270 100,325 L130,380 L270,380 L300,325 C320,270 330,210 290,160 Z"/>
            <!-- rankos -->
            <path d="M110,170 C45,210 20,260 40,315 C55,360 70,395 85,430 C92,450 98,465 108,475 L122,465 C110,430 102,395 118,350 C130,300 135,250 150,210 Z"/>
            <path d="M290,170 C355,210 380,260 360,315 C345,360 330,395 315,430 C308,450 302,465 292,475 L278,465 C290,430 298,395 282,350 C270,300 265,250 250,210 Z"/>
            <!-- dubuo -->
            <path d="M130,380 C140,430 145,450 160,465 L240,465 C255,450 260,430 270,380 Z"/>
            <!-- kojos -->
            <path d="M160,465 L145,740 L165,740 L185,465 Z"/>
            <path d="M240,465 L255,740 L235,740 L215,465 Z"/>
            <!-- pėdos -->
            <path d="M130,740 C110,760 140,772 165,772 L165,740 Z"/>
            <path d="M270,740 C290,760 260,772 235,772 L235,740 Z"/>
          </g>
        </g>

        <!-- BACK silhouette -->
        <g id="layer-back" class="hidden">
          <text x="16" y="28" class="label">NUGARA</text>
          <g class="silhouette" id="back-shape">
            <!-- galva -->
            <circle cx="200" cy="90" r="52"/>
            <!-- kaklas -->
            <path d="M180,142 L220,142 L228,160 L172,160 Z"/>
            <!-- nugara/mentys -->
            <path d="M110,160 C80,210 85,270 100,330 L130,385 L270,385 L300,330 C315,270 320,210 290,160 Z"/>
            <!-- rankos (galinė projekcija) -->
            <path d="M110,170 C55,210 35,255 50,305 C60,335 75,380 95,420 C105,440 112,458 120,470 L135,458 C125,430 115,400 125,360 C140,300 145,245 160,205 Z"/>
            <path d="M290,170 C345,210 365,255 350,305 C340,335 325,380 305,420 C295,440 288,458 280,470 L265,458 C275,430 285,400 275,360 C260,300 255,245 240,205 Z"/>
            <!-- dubuo -->
            <path d="M130,385 C140,435 145,452 160,468 L240,468 C255,452 260,435 270,385 Z"/>
            <!-- kojos -->
            <path d="M160,468 L148,740 L168,740 L188,468 Z"/>
            <path d="M240,468 L252,740 L232,740 L212,468 Z"/>
            <!-- pėdos -->
            <path d="M128,740 C108,760 138,772 164,772 L164,740 Z"/>
            <path d="M272,740 C292,760 262,772 236,772 L236,740 Z"/>
          </g>
        </g>

        <!-- MARKS container -->
        <g id="marks"></g>
      </svg>
      <div class="hint">Spragtelėkite ant figūros – įdedama pasirinkta žyma. Priekis/Nugara – perjungimas viršuje.</div>
    </section>

    <!-- Intervencijos -->
    <section class="card view" data-tab="Intervencijos">
      <h2>Intervencijos</h2>
      <div class="split">
        <div><h3 style="margin:0 0 6px;font-size:14px;color:var(--muted)">Medikamentai</h3><div class="grid cols-3" id="medications"></div></div>
        <div><h3 style="margin:0 0 6px;font-size:14px;color:var(--muted)">Procedūros</h3><div class="grid cols-3" id="procedures"></div></div>
      </div>
      <div class="hint" style="margin-top:6px">Paspaudus ant vaisto/procedūros automatiškai užpildomas laikas (galima koreguoti).</div>
    </section>

    <!-- Vaizdai / Laboratorija / Komanda / Ataskaita -->
    <section class="card view" data-tab="Vaizdiniai tyrimai"><h2>Vaizdiniai tyrimai</h2><div class="chip-group" id="imaging_basic"></div><h3 style="margin-top:12px;font-size:14px;color:var(--muted)">FAST</h3><div class="grid cols-3" id="fastGrid"></div></section>
    <section class="card view" data-tab="Laboratorija"><h2>Laboratoriniai tyrimai</h2><div class="chip-group" id="labs_basic"></div></section>
    <section class="card view" data-tab="Komanda"><h2>Komandos nariai</h2><div class="grid cols-3" id="teamGrid"></div></section>
    <section class="card view" data-tab="Ataskaita"><h2>Sugeneruotas tekstas</h2><textarea id="output" placeholder="Spauskite „Sugeneruoti ataskaitą“..."></textarea><div class="hint">Tekstą galima įklijuoti į LIS/ESIS.</div></section>
  </div>
</main>

<script src="js/app.js" defer type="module"></script>
</body>
</html>
